# ============================================
# Belldandy 环境变量配置模板
# 复制此文件为 .env.local 并填写实际值
# ============================================

# ------ 服务配置 ------
# Gateway 服务端口（默认 28889）
BELLDANDY_PORT=28889

# 绑定地址（默认 127.0.0.1，设置为 0.0.0.0 可局域网访问）
# BELLDANDY_HOST=127.0.0.1

# 状态目录（配对、记忆、人格文件存放路径；同时是 file_read/file_write/file_delete 的工作区根目录，默认 ~/.belldandy）
# BELLDANDY_STATE_DIR=~/.belldandy
# 额外允许 Agent 读写的根目录，逗号分隔（如其他盘符下的目录），不设则仅限上面状态目录
# BELLDANDY_EXTRA_WORKSPACE_ROOTS=E:\tools,D:\projects

# ------ 鉴权配置 ------
# 鉴权模式: none | token | password（默认 none）
# 注意：即使是 none，新设备连接也需要 Pairing 配对
BELLDANDY_AUTH_MODE=none
# 当 AUTH_MODE=token 时必填
# BELLDANDY_AUTH_TOKEN=your-secret-token
# 当 AUTH_MODE=password 时必填
# BELLDANDY_AUTH_PASSWORD=your-password

# WebSocket Origin 白名单（逗号分隔，防 CSWSH 攻击）
# 作用：限制哪些网页/客户端可以连接到 Belldandy Gateway
# 默认行为：若不设置，本地开发环境（HOST=127.0.0.1）自动允许 localhost/127.0.0.1
# 配置建议：
# - 纯本地使用（命令行）：不需要配置
# - 本地 Web 开发：BELLDANDY_ALLOWED_ORIGINS=http://localhost:5173
# - 公网部署/生产环境：BELLDANDY_ALLOWED_ORIGINS=https://console.belldandy.ai
# BELLDANDY_ALLOWED_ORIGINS=http://localhost:3000,https://app.example.com
# 多个地址用英文逗号 , 分隔

# ------ AI Provider 配置 ------
# Agent Provider: mock | openai（默认 mock）
BELLDANDY_AGENT_PROVIDER=openai

# OpenAI 协议配置（BELLDANDY_AGENT_PROVIDER=openai 时需要）
# 支持 OpenAI、Gemini、DeepSeek、Ollama 等兼容服务
BELLDANDY_OPENAI_BASE_URL="https://api.openai.com/v1"
BELLDANDY_OPENAI_API_KEY=sk-your-api-key-here
BELLDANDY_OPENAI_MODEL=gpt-4o

# Embedding Configuration (Optional, defaults to Agent config)
BELLDANDY_EMBEDDING_ENABLED=true
BELLDANDY_EMBEDDING_MODEL="text-embedding-ada-002"
BELLDANDY_EMBEDDING_OPENAI_API_KEY="" # Leave empty to use BELLDANDY_OPENAI_API_KEY
BELLDANDY_EMBEDDING_OPENAI_BASE_URL="" # Leave empty to use BELLDANDY_OPENAI_BASE_URL

# 流式输出（默认 true）
# BELLDANDY_OPENAI_STREAM=true
# 单次模型调用超时（毫秒，默认 120000 即 2 分钟）
# BELLDANDY_AGENT_TIMEOUT_MS=120000

# ------ 工具与能力 ------
# 启用工具调用（联网、读写文件等）
BELLDANDY_TOOLS_ENABLED=true

# 启用危险工具（run_command 等，默认 false）
# ⚠️ 仅在受信任环境下启用，允许执行任意命令
# 注：启用后命令执行仍受下方 TOOLS_POLICY_FILE 中 exec 规则约束（超时、白名单等）
# BELLDANDY_DANGEROUS_TOOLS_ENABLED=true

# 工具策略配置文件（JSON），用于覆盖默认的工具策略
# 控制已注册工具的执行限制（路径、超时、命令白/黑名单等）
# 示例：E:\\project\\belldandy\\config\\tools-policy.json
# BELLDANDY_TOOLS_POLICY_FILE=E:\\project\\belldandy\\config\\tools-policy.json
# 示例内容（JSON）：
# {
#   "allowedPaths": ["workspace", "notes"],
#   "deniedPaths": [".git", "node_modules", ".env"],
#   "exec": {
#     "quickTimeoutMs": 5000,
#     "longTimeoutMs": 300000,
#     "extraSafelist": ["terraform", "docker", "podman", "kubectl", "helm"],
#     "extraBlocklist": [],
#     "nonInteractive": {
#       "enabled": true,
#       "rules": {
#         "npm init": "-y",
#         "conda install": "-y"
#       }
#     }
#   }
# }



# ------ 记忆与向量检索 ------
# 启用向量搜索（需要 Embedding 模型）
# 模型存储路径
# 模型会自动下载并保存到你的工作区目录下的 .belldandy/models 文件夹中
BELLDANDY_EMBEDDING_ENABLED=true
# Embedding 提供商选择: openai | local (默认是 openai)
BELLDANDY_EMBEDDING_PROVIDER=local
# 本地模型名称 (仅当 provider=local 时生效)
# 默认使用 "BAAI/bge-m3"，这是一款性能非常强大的多语言模型
BELLDANDY_LOCAL_EMBEDDING_MODEL=BAAI/bge-base-en-v1.5
# 如果您的 Embedding 服务使用不同的 Key/BaseURL，请在此配置；否则默认使用上方的通用配置
# BELLDANDY_EMBEDDING_OPENAI_API_KEY="模型调用API_KEY"
# BELLDANDY_EMBEDDING_OPENAI_BASE_URL="模型调用地址"
# BELLDANDY_EMBEDDING_MODEL=text-embedding-ada-002
# Embedding 批处理大小 (默认 2)
# 减小此值可避免 413 Payload Too Large 错误
BELLDANDY_EMBEDDING_BATCH_SIZE=2


# ------ 心跳定时任务 ------
# 启用心跳（Agent 定期检查 HEARTBEAT.md 并主动联系你）
# BELLDANDY_HEARTBEAT_ENABLED=true
# 心跳间隔（支持 30m, 1h, 300s 格式）
# BELLDANDY_HEARTBEAT_INTERVAL=30m
# 活跃时段（可选，深夜不打扰）
# BELLDANDY_HEARTBEAT_ACTIVE_HOURS=08:00-23:00

# ------ 浏览器自动化 ------
# 启用浏览器中继自动启动（需配合 Chrome 扩展）
# BELLDANDY_BROWSER_RELAY_ENABLED=true
# BELLDANDY_RELAY_PORT=28892

# 浏览器域名控制（双模式，类似 web_fetch）
# 白名单：设置后仅允许访问这些域名（不设则不限制）
# BELLDANDY_BROWSER_ALLOWED_DOMAINS=trusted.com,docs.example.com
# 黑名单：禁止访问的域名（永远生效，优先于白名单）
# BELLDANDY_BROWSER_DENIED_DOMAINS=malware.com,phishing-site.net

# ------ MCP 支持 ------
# 启用 MCP 协议（需同时启用工具系统）
# BELLDANDY_MCP_ENABLED=true

# ------ 日志系统 ------
# 最低日志级别 (debug/info/warn/error)
# BELLDANDY_LOG_LEVEL=debug
# 日志目录，默认 ~/.belldandy/logs
# BELLDANDY_LOG_DIR=~/.belldandy/logs
# 单文件最大大小，超过则轮转 (如 10MB)
# BELLDANDY_LOG_MAX_SIZE=10MB
# 日志保留天数，超过自动清理
# BELLDANDY_LOG_RETENTION_DAYS=7
# 是否输出到控制台 / 是否写入文件
# BELLDANDY_LOG_CONSOLE=true
# BELLDANDY_LOG_FILE=true

# ------ 飞书渠道（可选）------
# BELLDANDY_FEISHU_APP_ID=cli_xxxxxxxxxxxxxxxx
# BELLDANDY_FEISHU_APP_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
